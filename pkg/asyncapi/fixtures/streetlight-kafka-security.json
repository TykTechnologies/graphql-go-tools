{
  "asyncapi": "2.4.0",
  "channels": {
    "smartylighting.streetlights.1.0.action.{streetlightId}.dim": {
      "parameters": {
        "streetlightId": {
          "description": "The ID of the streetlight.",
          "schema": {
            "type": "string"
          }
        }
      },
      "servers": [
        "test_oauth"
      ],
      "subscribe": {
        "message": {
          "name": "dimLight",
          "payload": {
            "properties": {
              "percentage": {
                "description": "Percentage to which the light should be dimmed to.",
                "maximum": 100,
                "minimum": 0,
                "type": "integer"
              },
              "sentAt": {
                "description": "Date and time when the message was sent.",
                "format": "date-time",
                "type": "string"
              }
            },
            "type": "object"
          },
          "summary": "Command a particular streetlight to dim the lights.",
          "title": "Dim light",
          "traits": [
            {
              "headers": {
                "properties": {
                  "my-app-header": {
                    "maximum": 100,
                    "minimum": 0,
                    "type": "integer"
                  }
                },
                "type": "object"
              }
            }
          ]
        },
        "operationId": "dimLight",
        "security": [
          {
            "streetlights_auth": [
              "streetlights:read"
            ]
          }
        ],
        "traits": [
          {
            "bindings": {
              "kafka": {
                "clientId": {
                  "enum": [
                    "my-app-id"
                  ],
                  "type": "string"
                }
              }
            }
          }
        ]
      }
    },
    "smartylighting.streetlights.1.0.action.{streetlightId}.turn.off": {
      "parameters": {
        "streetlightId": {
          "description": "The ID of the streetlight.",
          "schema": {
            "type": "string"
          }
        }
      },
      "servers": [
        "test_oauth"
      ],
      "subscribe": {
        "message": {
          "name": "turnOnOff",
          "payload": {
            "properties": {
              "command": {
                "description": "Whether to turn on or off the light.",
                "enum": [
                  "on",
                  "off"
                ],
                "type": "string"
              },
              "sentAt": {
                "description": "Date and time when the message was sent.",
                "format": "date-time",
                "type": "string"
              }
            },
            "type": "object"
          },
          "summary": "Command a particular streetlight to turn the lights on or off.",
          "title": "Turn on/off",
          "traits": [
            {
              "headers": {
                "properties": {
                  "my-app-header": {
                    "maximum": 100,
                    "minimum": 0,
                    "type": "integer"
                  }
                },
                "type": "object"
              }
            }
          ]
        },
        "operationId": "turnOff",
        "security": [
          {
            "streetlights_auth": [
              "streetlights:read"
            ]
          }
        ],
        "traits": [
          {
            "bindings": {
              "kafka": {
                "clientId": {
                  "enum": [
                    "my-app-id"
                  ],
                  "type": "string"
                }
              }
            }
          }
        ]
      }
    },
    "smartylighting.streetlights.1.0.action.{streetlightId}.turn.on": {
      "parameters": {
        "streetlightId": {
          "description": "The ID of the streetlight.",
          "schema": {
            "type": "string"
          }
        }
      },
      "servers": [
        "test_oauth"
      ],
      "subscribe": {
        "message": {
          "name": "turnOnOff",
          "payload": {
            "properties": {
              "command": {
                "description": "Whether to turn on or off the light.",
                "enum": [
                  "on",
                  "off"
                ],
                "type": "string"
              },
              "sentAt": {
                "description": "Date and time when the message was sent.",
                "format": "date-time",
                "type": "string"
              }
            },
            "type": "object"
          },
          "summary": "Command a particular streetlight to turn the lights on or off.",
          "title": "Turn on/off",
          "traits": [
            {
              "headers": {
                "properties": {
                  "my-app-header": {
                    "maximum": 100,
                    "minimum": 0,
                    "type": "integer"
                  }
                },
                "type": "object"
              }
            }
          ]
        },
        "operationId": "turnOn",
        "security": [
          {
            "streetlights_auth": [
              "streetlights:read"
            ]
          }
        ],
        "traits": [
          {
            "bindings": {
              "kafka": {
                "clientId": {
                  "enum": [
                    "my-app-id"
                  ],
                  "type": "string"
                }
              }
            }
          }
        ]
      }
    },
    "smartylighting.streetlights.1.0.event.{streetlightId}.lighting.measured": {
      "description": "The topic on which measured values may be produced and consumed.",
      "parameters": {
        "streetlightId": {
          "description": "The ID of the streetlight.",
          "schema": {
            "type": "string"
          }
        }
      },
      "publish": {
        "message": {
          "contentType": "application/json",
          "name": "lightMeasured",
          "payload": {
            "properties": {
              "lumens": {
                "description": "Light intensity measured in lumens.",
                "minimum": 0,
                "type": "integer"
              },
              "sentAt": {
                "description": "Date and time when the message was sent.",
                "format": "date-time",
                "type": "string"
              }
            },
            "type": "object"
          },
          "summary": "Inform about environmental lighting conditions of a particular streetlight.",
          "title": "Light measured",
          "traits": [
            {
              "headers": {
                "properties": {
                  "my-app-header": {
                    "maximum": 100,
                    "minimum": 0,
                    "type": "integer"
                  }
                },
                "type": "object"
              }
            }
          ]
        },
        "operationId": "receiveLightMeasurement",
        "summary": "Inform about environmental lighting conditions of a particular streetlight.",
        "traits": [
          {
            "bindings": {
              "kafka": {
                "clientId": {
                  "enum": [
                    "my-app-id"
                  ],
                  "type": "string"
                }
              }
            }
          }
        ]
      },
      "servers": [
        "test"
      ]
    }
  },
  "components": {
    "messageTraits": {
      "commonHeaders": {
        "headers": {
          "properties": {
            "my-app-header": {
              "maximum": 100,
              "minimum": 0,
              "type": "integer"
            }
          },
          "type": "object"
        }
      }
    },
    "messages": {
      "dimLight": {
        "name": "dimLight",
        "payload": {
          "properties": {
            "percentage": {
              "description": "Percentage to which the light should be dimmed to.",
              "maximum": 100,
              "minimum": 0,
              "type": "integer"
            },
            "sentAt": {
              "description": "Date and time when the message was sent.",
              "format": "date-time",
              "type": "string"
            }
          },
          "type": "object"
        },
        "summary": "Command a particular streetlight to dim the lights.",
        "title": "Dim light",
        "traits": [
          {
            "headers": {
              "properties": {
                "my-app-header": {
                  "maximum": 100,
                  "minimum": 0,
                  "type": "integer"
                }
              },
              "type": "object"
            }
          }
        ]
      },
      "lightMeasured": {
        "contentType": "application/json",
        "name": "lightMeasured",
        "payload": {
          "properties": {
            "lumens": {
              "description": "Light intensity measured in lumens.",
              "minimum": 0,
              "type": "integer"
            },
            "sentAt": {
              "description": "Date and time when the message was sent.",
              "format": "date-time",
              "type": "string"
            }
          },
          "type": "object"
        },
        "summary": "Inform about environmental lighting conditions of a particular streetlight.",
        "title": "Light measured",
        "traits": [
          {
            "headers": {
              "properties": {
                "my-app-header": {
                  "maximum": 100,
                  "minimum": 0,
                  "type": "integer"
                }
              },
              "type": "object"
            }
          }
        ]
      },
      "turnOnOff": {
        "name": "turnOnOff",
        "payload": {
          "properties": {
            "command": {
              "description": "Whether to turn on or off the light.",
              "enum": [
                "on",
                "off"
              ],
              "type": "string"
            },
            "sentAt": {
              "description": "Date and time when the message was sent.",
              "format": "date-time",
              "type": "string"
            }
          },
          "type": "object"
        },
        "summary": "Command a particular streetlight to turn the lights on or off.",
        "title": "Turn on/off",
        "traits": [
          {
            "headers": {
              "properties": {
                "my-app-header": {
                  "maximum": 100,
                  "minimum": 0,
                  "type": "integer"
                }
              },
              "type": "object"
            }
          }
        ]
      }
    },
    "operationTraits": {
      "kafka": {
        "bindings": {
          "kafka": {
            "clientId": {
              "enum": [
                "my-app-id"
              ],
              "type": "string"
            }
          }
        }
      }
    },
    "parameters": {
      "streetlightId": {
        "description": "The ID of the streetlight.",
        "schema": {
          "type": "string"
        }
      }
    },
    "schemas": {
      "dimLightPayload": {
        "properties": {
          "percentage": {
            "description": "Percentage to which the light should be dimmed to.",
            "maximum": 100,
            "minimum": 0,
            "type": "integer"
          },
          "sentAt": {
            "description": "Date and time when the message was sent.",
            "format": "date-time",
            "type": "string"
          }
        },
        "type": "object"
      },
      "lightMeasuredPayload": {
        "properties": {
          "lumens": {
            "description": "Light intensity measured in lumens.",
            "minimum": 0,
            "type": "integer"
          },
          "sentAt": {
            "description": "Date and time when the message was sent.",
            "format": "date-time",
            "type": "string"
          }
        },
        "type": "object"
      },
      "sentAt": {
        "description": "Date and time when the message was sent.",
        "format": "date-time",
        "type": "string"
      },
      "turnOnOffPayload": {
        "properties": {
          "command": {
            "description": "Whether to turn on or off the light.",
            "enum": [
              "on",
              "off"
            ],
            "type": "string"
          },
          "sentAt": {
            "description": "Date and time when the message was sent.",
            "format": "date-time",
            "type": "string"
          }
        },
        "type": "object"
      }
    },
    "securitySchemes": {
      "saslScram": {
        "description": "Provide your username and password for SASL/SCRAM authentication",
        "type": "scramSha256"
      },
      "streetlights_auth": {
        "description": "The oauth security descriptions",
        "flows": {
          "clientCredentials": {
            "scopes": {
              "streetlights:read": "Scope required for subscribing to channel",
              "streetlights:write": "Scope required for publishing to channel"
            },
            "tokenUrl": "https://example.com/api/oauth/dialog"
          }
        },
        "type": "oauth2"
      }
    }
  },
  "defaultContentType": "application/json",
  "info": {
    "description": "The Smartylighting Streetlights API allows you to remotely manage the city lights.\n\n### Check out its awesome features:\n\n* Turn a specific streetlight on/off 🌃\n* Dim a specific streetlight 😎\n* Receive real-time information about environmental lighting conditions 📈\n",
    "license": {
      "name": "Apache 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0"
    },
    "title": "Streetlights Kafka API",
    "version": "1.0.0"
  },
  "servers": {
    "test": {
      "description": "Test broker",
      "protocol": "kafka-secure",
      "security": [
        {
          "saslScram": []
        }
      ],
      "url": "test.mykafkacluster.org:8092"
    },
    "test_oauth": {
      "description": "Test port for oauth",
      "protocol": "kafka-secure",
      "security": [
        {
          "streetlights_auth": [
            "streetlights:write",
            "streetlights:read"
          ]
        }
      ],
      "url": "test.mykafkacluster.org:8093"
    }
  }
}